<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">Aeq</span>,<span class="var type1" id="S3T2U4">beq</span>,<span class="var type1" id="S4T3U5">Aiq</span>,<span class="var type1" id="S5T4U6">biq</span>,<span class="var type1" id="S6T5U7">H</span>,<span class="var type1" id="S7T6U8">f</span>] = temp_MPC3DFootV98_form_Step0(<span class="var type1" id="S8T7U11">states</span>,<span class="var type1" id="S9T8U12">Nodes</span>,<span class="var type1" id="S10T9U13">r</span>,<span class="var type1" id="S11T10U14">qo</span>,<span class="var type1" id="S12T11U15">states_ref</span>,<span class="var type1" id="S13T12U16">MPC_index</span>,<span class="var type1" id="S14T13U17">weights</span>,<span class="var type1" id="S15T7U18">foot_info</span>,<span class="var type1" id="S16T14U19">foot_obs_info</span>,<span class="var type1" id="S17T15U20">foot_future_info</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%TEMP_MPC_FORM Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%   Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   This function formulates all the matrices for MPC QP</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   states: current robot states, include CoM states and foot placement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   Nodes: Number of nodes in MPC prediction</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   r: radius for obstacle avoidance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   qo: obstacle states</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%   states_ref: desired robot states</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   MPC_index : left/right step index, contact sequence index</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   weights   : weight in the MPC cost function</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% unpack inputs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="mxinfo " id="T12:U17"><span class="var type1" id="S18T12U23">CoM_x</span> = <span class="mxinfo " id="T12:U19"><span class="var type1" id="S8T7U25">states</span>(<span class="mxinfo " id="T16:U21">1:2</span>,<span class="mxinfo " id="T17:U22">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo " id="T12:U23"><span class="var type1" id="S19T12U32">CoM_y</span> = <span class="mxinfo " id="T12:U25"><span class="var type1" id="S8T7U34">states</span>(<span class="mxinfo " id="T16:U27">3:4</span>,<span class="mxinfo " id="T17:U28">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T12:U29"><span class="var type1" id="S20T12U41">CoM_z</span> = <span class="mxinfo " id="T12:U31"><span class="var type1" id="S8T7U43">states</span>(<span class="mxinfo " id="T16:U33">7:8</span>,<span class="mxinfo " id="T17:U34">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T8:U35"><span class="var type1" id="S21T8U50">CP_x</span> = <span class="mxinfo " id="T8:U37"><span class="var type1" id="S8T7U52">states</span>(<span class="mxinfo " id="T17:U39">5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T8:U40"><span class="var type1" id="S22T8U56">CP_y</span> = <span class="mxinfo " id="T8:U42"><span class="var type1" id="S8T7U58">states</span>(<span class="mxinfo " id="T17:U44">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="mxinfo " id="T12:U45"><span class="var type1" id="S23T12U62">x_ref</span> = <span class="mxinfo " id="T12:U47"><span class="var type1" id="S12T11U64">states_ref</span>(<span class="mxinfo " id="T16:U49">1:2</span>,<span class="mxinfo " id="T17:U50">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="mxinfo " id="T12:U51"><span class="var type1" id="S24T12U71">y_ref</span> = <span class="mxinfo " id="T12:U53"><span class="var type1" id="S12T11U73">states_ref</span>(<span class="mxinfo " id="T16:U55">3:4</span>,<span class="mxinfo " id="T17:U56">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="mxinfo " id="T12:U57"><span class="var type1" id="S25T12U80">z_ref</span> = <span class="mxinfo " id="T12:U59"><span class="var type1" id="S12T11U82">states_ref</span>(<span class="mxinfo " id="T16:U61">5:6</span>,<span class="mxinfo " id="T17:U62">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="mxinfo " id="T18:U63"><span class="var type1" id="S23T18U89">x_ref</span> = <span class="mxinfo " id="T18:U65">[<span class="var type1" id="S23T12U92">x_ref</span>;<span class="mxinfo " id="T10:U67"><span class="mxinfo " id="T8:U68"><span class="var type1" id="S12T11U96">states_ref</span>(<span class="mxinfo " id="T17:U70">59</span>)</span>*<span class="mxinfo " id="T10:U71">ones(<span class="mxinfo " id="T8:U72">3</span>,1)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="mxinfo " id="T18:U73"><span class="var type1" id="S24T18U104">y_ref</span> = <span class="mxinfo " id="T18:U75">[<span class="mxinfo " id="T8:U76"><span class="var type1" id="S24T12U108">y_ref</span>(<span class="mxinfo " id="T17:U78">1</span>)</span>;<span class="mxinfo " id="T9:U79"><span class="var type1" id="S12T11U112">states_ref</span>(<span class="mxinfo " id="T19:U81">60:63</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="mxinfo " id="T8:U82"><span class="var type1" id="S27T8U118">zh</span> = <span class="mxinfo " id="T8:U84"><span class="var type1" id="S12T11U120">states_ref</span>(<span class="mxinfo " id="T17:U86">7</span>,<span class="mxinfo " id="T17:U87">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="mxinfo " id="T20:U88"><span class="var type1" id="S28T20U125">x_traj</span> = <span class="mxinfo " id="T20:U90"><span class="mxinfo " id="T21:U91"><span class="var type1" id="S12T11U128">states_ref</span>(<span class="mxinfo " id="T22:U93">8:24</span>,<span class="mxinfo " id="T17:U94">1</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="mxinfo " id="T20:U95"><span class="var type1" id="S29T20U135">y_traj</span> = <span class="mxinfo " id="T20:U97"><span class="mxinfo " id="T21:U98"><span class="var type1" id="S12T11U138">states_ref</span>(<span class="mxinfo " id="T22:U100">25:41</span>,<span class="mxinfo " id="T17:U101">1</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T20:U102"><span class="var type1" id="S30T20U145">z_traj</span> = <span class="mxinfo " id="T20:U104"><span class="mxinfo " id="T21:U105"><span class="var type1" id="S12T11U148">states_ref</span>(<span class="mxinfo " id="T22:U107">42:58</span>,<span class="mxinfo " id="T17:U108">1</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T8:U109"><span class="var type1" id="S31T8U155">r_min</span>  = <span class="mxinfo " id="T8:U111"><span class="var type1" id="S10T9U157">r</span>(<span class="mxinfo " id="T17:U113">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo " id="T8:U114"><span class="var type1" id="S32T8U161">r_min2</span> = <span class="mxinfo " id="T8:U116"><span class="var type1" id="S10T9U163">r</span>(<span class="mxinfo " id="T17:U118">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T8:U119"><span class="var type1" id="S33T8U167">step_index</span> = <span class="mxinfo " id="T8:U121"><span class="var type1" id="S13T12U169">MPC_index</span>(<span class="mxinfo " id="T17:U123">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo " id="T8:U124"><span class="var type1" id="S34T8U173">con_index</span>  = <span class="mxinfo " id="T8:U126"><span class="var type1" id="S13T12U175">MPC_index</span>(<span class="mxinfo " id="T8:U128">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T8:U129"><span class="var type1" id="S35T8U179">ob_cost</span> = <span class="mxinfo " id="T8:U131"><span class="var type1" id="S14T13U181">weights</span>(<span class="mxinfo " id="T17:U133">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="mxinfo " id="T12:U134"><span class="var type1" id="S36T12U185">Qx</span> = <span class="mxinfo " id="T12:U136"><span class="var type1" id="S14T13U187">weights</span>(<span class="mxinfo " id="T23:U138">2:3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T12:U139"><span class="var type1" id="S37T12U193">Qy</span> = <span class="mxinfo " id="T12:U141"><span class="var type1" id="S14T13U195">weights</span>(<span class="mxinfo " id="T23:U143">4:5</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="mxinfo " id="T8:U144"><span class="var type1" id="S38T8U201">cRx</span> = <span class="mxinfo " id="T8:U146"><span class="var type1" id="S14T13U203">weights</span>(<span class="mxinfo " id="T17:U148">6</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T8:U149"><span class="var type1" id="S39T8U207">cRy</span> = <span class="mxinfo " id="T8:U151"><span class="var type1" id="S14T13U209">weights</span>(<span class="mxinfo " id="T17:U153">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T8:U154"><span class="var type1" id="S40T8U213">cWx</span> = <span class="mxinfo " id="T8:U156"><span class="var type1" id="S14T13U215">weights</span>(<span class="mxinfo " id="T17:U158">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="mxinfo " id="T8:U159"><span class="var type1" id="S41T8U219">cWy</span> = <span class="mxinfo " id="T8:U161"><span class="var type1" id="S14T13U221">weights</span>(<span class="mxinfo " id="T17:U163">9</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T12:U164"><span class="var type1" id="S42T12U225">Qz</span> = <span class="mxinfo " id="T12:U166"><span class="var type1" id="S14T13U227">weights</span>(<span class="mxinfo " id="T23:U168">10:11</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="mxinfo " id="T8:U169"><span class="var type1" id="S43T8U233">cRz</span> = <span class="mxinfo " id="T8:U171"><span class="var type1" id="S14T13U235">weights</span>(<span class="mxinfo " id="T17:U173">12</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T9:U174"><span class="var type1" id="S44T9U239">p2</span> = <span class="mxinfo " id="T9:U176"><span class="var type1" id="S14T13U241">weights</span>(<span class="mxinfo " id="T19:U178">13:16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="mxinfo " id="T10:U179"><span class="var type1" id="S45T10U247">ftx</span> = <span class="mxinfo " id="T10:U181"><span class="var type1" id="S15T7U249">foot_info</span>(<span class="mxinfo " id="T24:U183">1:3</span>,<span class="mxinfo " id="T17:U184">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"><span class="mxinfo " id="T10:U185"><span class="var type1" id="S46T10U256">fty</span> = <span class="mxinfo " id="T10:U187"><span class="var type1" id="S15T7U258">foot_info</span>(<span class="mxinfo " id="T24:U189">4:6</span>,<span class="mxinfo " id="T17:U190">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T12:U191"><span class="var type1" id="S47T12U265">d_foot</span> = <span class="mxinfo " id="T12:U193"><span class="var type1" id="S15T7U267">foot_info</span>(<span class="mxinfo " id="T16:U195">7:8</span>,<span class="mxinfo " id="T17:U196">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"><span class="mxinfo " id="T25:U197"><span class="var type1" id="S48T25U274">r1</span> = <span class="mxinfo " id="T25:U199">[<span class="mxinfo " id="T26:U200"><span class="var type1" id="S31T8U278">r_min</span>.*<span class="mxinfo " id="T26:U202">ones(<span class="mxinfo " id="T8:U203">1</span>,<span class="var type1" id="S9T8U282">Nodes</span>)</span></span>;<span class="mxinfo " id="T26:U205"><span class="mxinfo " id="T8:U206"><span class="var type1" id="S10T9U286">r</span>(<span class="mxinfo " id="T17:U208">3</span>)</span>*<span class="mxinfo " id="T26:U209">ones(<span class="mxinfo " id="T8:U210">1</span>,<span class="var type1" id="S9T8U291">Nodes</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T25:U212"><span class="var type1" id="S49T25U294">r2</span> = <span class="mxinfo " id="T25:U214">[<span class="mxinfo " id="T26:U215"><span class="var type1" id="S32T8U298">r_min2</span>.*<span class="mxinfo " id="T26:U217">ones(<span class="mxinfo " id="T8:U218">1</span>,<span class="var type1" id="S9T8U302">Nodes</span>)</span></span>;<span class="mxinfo " id="T26:U220"><span class="mxinfo " id="T8:U221"><span class="var type1" id="S10T9U306">r</span>(<span class="mxinfo " id="T17:U223">4</span>)</span>*<span class="mxinfo " id="T26:U224">ones(<span class="mxinfo " id="T8:U225">1</span>,<span class="var type1" id="S9T8U311">Nodes</span>)</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"><span class="mxinfo " id="T27:U227"><span class="var type1" id="S50T27U314">foot_ic</span> = <span class="mxinfo " id="T27:U229"><span class="var type1" id="S16T14U316">foot_obs_info</span>(<span class="mxinfo " id="T28:U231">1:7</span>,<span class="mxinfo " id="T17:U232">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="mxinfo " id="T29:U233"><span class="var type1" id="S51T29U323">fobs_ic</span> = <span class="mxinfo " id="T29:U235"><span class="var type1" id="S16T14U325">foot_obs_info</span>(<span class="mxinfo " id="T30:U237">8:22</span>,<span class="mxinfo " id="T17:U238">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="mxinfo " id="T8:U239"><span class="var type1" id="S52T8U332">step_height</span> = <span class="mxinfo " id="T8:U241"><span class="var type1" id="S16T14U334">foot_obs_info</span>(<span class="mxinfo " id="T17:U243">23</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T18:U244"><span class="var type1" id="S53T18U338">x_foot_traj</span> = <span class="mxinfo " id="T18:U246"><span class="mxinfo " id="T31:U247">linspace(<span class="mxinfo " id="T8:U248"><span class="var type1" id="S50T27U343">foot_ic</span>(<span class="mxinfo " id="T17:U250">4</span>)</span>,<span class="mxinfo " id="T8:U251"><span class="var type1" id="S50T27U346">foot_ic</span>(<span class="mxinfo " id="T17:U253">6</span>)</span>,5)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T32:U254"><span class="var type1" id="S33T8U352">step_index</span> == <span class="mxinfo " id="T8:U256">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo " id="T18:U257"><span class="var type1" id="S55T18U356">y_foot_traj</span> = <span class="mxinfo " id="T18:U259"><span class="mxinfo " id="T31:U260">linspace(<span class="mxinfo " id="T8:U261"><span class="var type1" id="S50T27U361">foot_ic</span>(<span class="mxinfo " id="T17:U263">5</span>)</span>,<span class="mxinfo " id="T8:U264"><span class="var type1" id="S50T27U364">foot_ic</span>(<span class="mxinfo " id="T17:U266">7</span>)</span>,5)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T18:U267"><span class="var type1" id="S55T18U370">y_foot_traj</span> = <span class="mxinfo " id="T18:U269"><span class="mxinfo " id="T31:U270">linspace(<span class="mxinfo " id="T8:U271"><span class="var type1" id="S50T27U375">foot_ic</span>(<span class="mxinfo " id="T17:U273">5</span>)</span>,<span class="mxinfo " id="T8:U274"><span class="var type1" id="S50T27U378">foot_ic</span>(<span class="mxinfo " id="T17:U276">7</span>)</span>,5)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="mxinfo " id="T18:U277"><span class="var type1" id="S56T18U383">z_foot_traj</span> = <span class="mxinfo " id="T18:U279">[<span class="mxinfo " id="T8:U280">0</span>;<span class="mxinfo " id="T8:U281"><span class="var type1" id="S52T8U389">step_height</span>/<span class="mxinfo " id="T8:U283">2</span></span>;<span class="var type1" id="S52T8U392">step_height</span>;<span class="mxinfo " id="T8:U285"><span class="var type1" id="S52T8U395">step_height</span>/<span class="mxinfo " id="T8:U287">2</span></span>;<span class="mxinfo " id="T8:U288">0</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T33:U289"><span class="var type1" id="S57T33U401">eq_in</span> = <span class="mxinfo " id="T33:U291">[<span class="var type1" id="S21T8U404">CP_x</span>;<span class="var type1" id="S22T8U406">CP_y</span>;<span class="var type1" id="S50T27U408">foot_ic</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="mxinfo " id="T34:U295"><span class="var type1" id="S58T34U411">iq_in</span> = <span class="mxinfo " id="T34:U297">[<span class="var type1" id="S51T29U414">fobs_ic</span>;<span class="var type1" id="S53T18U416">x_foot_traj</span>;<span class="var type1" id="S55T18U418">y_foot_traj</span>;<span class="var type1" id="S56T18U420">z_foot_traj</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T35:U302"><span class="var type1" id="S59T35U423">obj_in</span> = <span class="mxinfo " id="T35:U304">[<span class="var type1" id="S44T9U426">p2</span>;<span class="var type1" id="S53T18U428">x_foot_traj</span>;<span class="var type1" id="S55T18U430">y_foot_traj</span>;<span class="var type1" id="S56T18U432">z_foot_traj</span>;<span class="var type1" id="S50T27U434">foot_ic</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo " id="T9:U310"><span class="var type1" id="S60T9U437">in1</span> = <span class="mxinfo " id="T9:U312"><span class="var type1" id="S17T15U439">foot_future_info</span>(<span class="mxinfo " id="T19:U314">1:4</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="mxinfo " id="T9:U315"><span class="var type1" id="S61T9U445">in2</span> = <span class="mxinfo " id="T9:U317"><span class="var type1" id="S17T15U447">foot_future_info</span>(<span class="mxinfo " id="T19:U319">5:8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="mxinfo " id="T7:U320"><span class="var type1" id="S62T7U453">in3</span> = <span class="mxinfo " id="T7:U322"><span class="var type1" id="S17T15U455">foot_future_info</span>(<span class="mxinfo " id="T36:U324">9:16</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="mxinfo " id="T9:U325"><span class="var type1" id="S63T9U461">in4</span> = <span class="mxinfo " id="T9:U327"><span class="var type1" id="S17T15U463">foot_future_info</span>(<span class="mxinfo " id="T19:U329">17:20</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"><span class="comment">% [Aeq,beq] = EqualityConstraints_LeftStartV4(CoM_x,CoM_y);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">% [Aiq,biq] = InequalityConstraints_LeftStartV4(CoM_x, CoM_y, qo, r1, r2, ob_cost ,CP_x,CP_y,foot_dis);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">% </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">% % Develop The Objective Function Matrix and Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="comment">% [H,f] = ObjectiveFunction_LeftStart0V4(CP_x,CP_y,vel_des(1), vel_des(2),Qx,Qy,cRx,cRy,cWx,cWy);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T32:U330"><span class="var type1" id="S33T8U470">step_index</span> == <span class="mxinfo " id="T8:U332">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">    <span class="comment">% Develop the Constraints Matrix and Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">    [<span class="var type1" id="S2T1U475">Aeq</span>,<span class="var type1" id="S3T2U476">beq</span>] = <span class="fcn" id="F69N2:B478">Eq_LeftStart03DFootV98</span>(<span class="var type1" id="S18T12U479">CoM_x</span>,<span class="var type1" id="S19T12U480">CoM_y</span>, <span class="var type1" id="S20T12U481">CoM_z</span>, <span class="var type1" id="S27T8U482">zh</span>,<span class="var type1" id="S45T10U483">ftx</span>,<span class="var type1" id="S46T10U484">fty</span>, <span class="var type1" id="S57T33U485">eq_in</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    [<span class="var type1" id="S4T3U489">Aiq</span>,<span class="var type1" id="S5T4U490">biq</span>] = <span class="fcn" id="F93N4:B492">Iq_LeftStart03DFootV98</span>(<span class="var type1" id="S18T12U493">CoM_x</span>, <span class="var type1" id="S19T12U494">CoM_y</span>,<span class="var type1" id="S20T12U495">CoM_z</span>,<span class="var type1" id="S28T20U496">x_traj</span>,<span class="var type1" id="S29T20U497">y_traj</span>,<span class="var type1" id="S30T20U498">z_traj</span>, <span class="var type1" id="S11T10U499">qo</span>, <span class="var type1" id="S48T25U500">r1</span>, <span class="var type1" id="S49T25U501">r2</span> ,<span class="var type1" id="S21T8U502">CP_x</span>,<span class="var type1" id="S22T8U503">CP_y</span>,<span class="var type1" id="S45T10U504">ftx</span>,<span class="var type1" id="S46T10U505">fty</span>,<span class="var type1" id="S47T12U506">d_foot</span>, <span class="var type1" id="S58T34U507">iq_in</span>,<span class="var type1" id="S60T9U508">in1</span>,<span class="var type1" id="S61T9U509">in2</span>,<span class="var type1" id="S62T7U510">in3</span>,<span class="var type1" id="S63T9U511">in4</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="comment">% Develop The Objective Function Matrix and Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    [<span class="var type1" id="S6T5U515">H</span>,<span class="var type1" id="S7T6U516">f</span>] = <span class="fcn" id="F98N6:B518">Obj_LeftStart03DFootV98</span>(<span class="var type1" id="S21T8U519">CP_x</span>,<span class="var type1" id="S22T8U520">CP_y</span>,<span class="var type1" id="S23T18U521">x_ref</span>, <span class="var type1" id="S24T18U522">y_ref</span>,<span class="var type1" id="S25T12U523">z_ref</span>, <span class="var type1" id="S36T12U524">Qx</span>,<span class="var type1" id="S37T12U525">Qy</span>,<span class="var type1" id="S42T12U526">Qz</span>,<span class="var type1" id="S38T8U527">cRx</span>,<span class="var type1" id="S39T8U528">cRy</span>,<span class="var type1" id="S43T8U529">cRz</span>,<span class="var type1" id="S40T8U530">cWx</span>,<span class="var type1" id="S41T8U531">cWy</span>, <span class="var type1" id="S35T8U532">ob_cost</span>, <span class="var type1" id="S45T10U533">ftx</span>, <span class="var type1" id="S59T35U534">obj_in</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    <span class="comment">% Develop the Constraints Matrix and Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    [<span class="var type1" id="S2T1U539">Aeq</span>,<span class="var type1" id="S3T2U540">beq</span>] = <span class="fcn" id="F99N3:B542">Eq_RightStart03DFootV98</span>(<span class="var type1" id="S18T12U543">CoM_x</span>,<span class="var type1" id="S19T12U544">CoM_y</span>, <span class="var type1" id="S20T12U545">CoM_z</span>, <span class="var type1" id="S27T8U546">zh</span>,<span class="var type1" id="S45T10U547">ftx</span>,<span class="var type1" id="S46T10U548">fty</span>, <span class="var type1" id="S57T33U549">eq_in</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    [<span class="var type1" id="S4T3U553">Aiq</span>,<span class="var type1" id="S5T4U554">biq</span>] = <span class="fcn" id="F100N5:B556">Iq_RightStart03DFootV98</span>(<span class="var type1" id="S18T12U557">CoM_x</span>, <span class="var type1" id="S19T12U558">CoM_y</span>, <span class="var type1" id="S20T12U559">CoM_z</span>,<span class="var type1" id="S28T20U560">x_traj</span>,<span class="var type1" id="S29T20U561">y_traj</span>,<span class="var type1" id="S30T20U562">z_traj</span>, <span class="var type1" id="S11T10U563">qo</span>, <span class="var type1" id="S48T25U564">r1</span>, <span class="var type1" id="S49T25U565">r2</span>, <span class="var type1" id="S21T8U566">CP_x</span>,<span class="var type1" id="S22T8U567">CP_y</span>,<span class="var type1" id="S45T10U568">ftx</span>,<span class="var type1" id="S46T10U569">fty</span>,<span class="var type1" id="S47T12U570">d_foot</span>, <span class="var type1" id="S58T34U571">iq_in</span>,<span class="var type1" id="S60T9U572">in1</span>,<span class="var type1" id="S61T9U573">in2</span>,<span class="var type1" id="S62T7U574">in3</span>,<span class="var type1" id="S63T9U575">in4</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="comment">% Develop The Objective Function Matrix and Vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    [<span class="var type1" id="S6T5U579">H</span>,<span class="var type1" id="S7T6U580">f</span>] = <span class="fcn" id="F101N7:B582">Obj_RightStart03DFootV98</span>(<span class="var type1" id="S21T8U583">CP_x</span>,<span class="var type1" id="S22T8U584">CP_y</span>,<span class="var type1" id="S23T18U585">x_ref</span>, <span class="var type1" id="S24T18U586">y_ref</span>,<span class="var type1" id="S25T12U587">z_ref</span>,<span class="var type1" id="S36T12U588">Qx</span>,<span class="var type1" id="S37T12U589">Qy</span>,<span class="var type1" id="S42T12U590">Qz</span>,<span class="var type1" id="S38T8U591">cRx</span>,<span class="var type1" id="S39T8U592">cRy</span>,<span class="var type1" id="S43T8U593">cRz</span>,<span class="var type1" id="S40T8U594">cWx</span>,<span class="var type1" id="S41T8U595">cWy</span>,<span class="var type1" id="S35T8U596">ob_cost</span>, <span class="var type1" id="S45T10U597">ftx</span>, <span class="var type1" id="S59T35U598">obj_in</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"></span></span>
</pre>
</body>
</html>
